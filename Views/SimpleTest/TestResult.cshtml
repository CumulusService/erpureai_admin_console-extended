<!DOCTYPE html>
<html>
<head>
    <title>Graph Test Result</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-4">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1>Microsoft Graph Test Result</h1>
            <a href="/Account/SignOut" class="btn btn-outline-secondary">Sign Out</a>
        </div>

        @if (ViewBag.Error != null)
        {
            <div class="alert alert-danger">
                <h4>‚ùå Error</h4>
                <p>@ViewBag.Error</p>
            </div>
        }

        @if (ViewBag.Success != null)
        {
            <div class="alert alert-success">
                <h4>@ViewBag.Success</h4>
            </div>

            <div class="card">
                <div class="card-body">
                    <h5>Invitation Details:</h5>
                    
                    @if (ViewBag.UserDetails != null)
                    {
                        <p><strong>User ID:</strong> @ViewBag.UserDetails</p>
                    }
                    
                    @if (ViewBag.Email != null)
                    {
                        <p><strong>Email:</strong> @ViewBag.Email</p>
                    }
                </div>
            </div>
        }

        <div class="mt-3">
            <a href="/SimpleTest/Test" class="btn btn-primary">Test Another</a>
            <a href="/Test/Invite" class="btn btn-secondary">Full Test (with Dataverse)</a>
        </div>
    </div>
</body>
</html>